# 迭代开发-代码版本管理

在开发过程中，会遇到代码管理问题，比如说：一个线上的BUG，如何进行修改和发布。这需要一个合理的代码管理。

## 代码版本

通常，我们会采用**x.y.z**的格式来定义版本号，而**考虑到机器和人的区别**，出现了两种方式的版本号定义：

* **versionName**：也就是x.y.z，便于人类识别的版本号
* **versionCode**：通过x.y.z计算出来的数值，便于计算机识别的版本号

versionName的公式为：

> versionName = x.y.z , 且 x.y.z 都为数字

* x -> 主版本号，无上限
* y -> 小功能版本号，上限 99(可以根据实际情况调整)
* z -> 修订版本号（修复BUG），上限 99(可以根据实际情况调整)

versionCode计算公式为：

> versionCode = x \* 10000 + y \* 100 + z 的格式命名

通常采用versionCode作为系统内部的版本对比数值

## 代码版本结构

代码版本结构（采用git管理）：

```
/tag 标签
    /tag-v1.0.0         v1.0.0版本
    /tag-v1.0.1         v1.0.1版本, 修复了v1.0.0版本的某些BUG
/branch 分支
    /master             最后一次发布的代码版本，发布完成后需要打tag
    /dev-v2.0.0         v2.0.0 版本开发分支
    /dev-v2.0.0-{todo}  v2.0.0 todo功能开发分支，开发完成后，merge到dev-v2.0.0中
    /fix-v1.0.2         v1.0.2 版本修复分支
    /test-{todo}        实验性质的分支，不同步到repo上

```
注意：对于Android APP的发布后，打tag的时候需要**上传apk和mapping文件**，方便之后定位线上bug